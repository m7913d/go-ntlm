// BSD License please see License file for more information

package ntlm

import (
        "bytes"
        "encoding/hex"
        "testing"
)

func TestAvPairsTrailingZeros(t *testing.T) {
        byteData, _ := hex.DecodeString("02000e004500580041004d0050004c004500010010004500580041004d0050004c0045003100040016006500780061006d0070006c0065002e0063006f006d00030028006500780061006d0070006c00650031002e006500780061006d0070006c0065002e0063006f006d00050016006500780061006d0070006c0065002e0063006f006d0006000400020000000a001000921fbe4f297e14c88b10c94ec9de94e809002e0048005400540050002f00720064007000670077002e006d0079002d0064007200650061006d0073002e006200650000000000000000000000000000000000000000000000000000000000")

        pairs, _ := ReadAvPairs(byteData)

        if !bytes.Equal(byteData, pairs.Bytes()) {
                t.Error("AvPairs (un)marshalling is not consistent")
        }
}
